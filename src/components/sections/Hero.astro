---
import LinkBlend from "@/components/primitives/LinkBlend.astro";
import ScrambleText from "@/components/primitives/ScrambleText.astro";
import Logo from "@/components/primitives/Logo.astro";
import AnimatedLogoReact from "@/components/AnimatedLogoReact.tsx";
import {
  getLangFromUrl,
  useTranslations,
  useTranslatedPath,
} from "@/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);
---

<section
  id="hero"
  class="bg-everylanguage-black relative flex min-h-screen items-center justify-center overflow-hidden"
>
  <div
    class="from-everylanguage-black-soft to-everylanguage-black absolute inset-0 bg-gradient-to-b"
  >
  </div>
  <div class="container relative z-10 mx-auto px-4">
    <div class="flex flex-col items-center justify-center gap-8 md:gap-16">
      <div class="m-auto flex w-full justify-center">
        <h1 class="sr-only">Every Language</h1>
        <!-- Desktop version -->
        <div class="hidden lg:block">
          <ScrambleText
            text="EVERY LANGUAGE"
            class="text-everylanguage-white whitespace-nowrap text-7xl tracking-tight"
            letterClass="font-display"
            shuffleTime={80}
            cyclesPerLetter={2}
          />
        </div>
        <!-- Mobile version -->
        <div class="flex flex-col items-center gap-2 lg:hidden">
          <ScrambleText
            text="EVERY"
            class="text-everylanguage-white whitespace-nowrap text-4xl sm:text-5xl md:text-6xl tracking-tight"
            letterClass="font-display"
            shuffleTime={80}
            cyclesPerLetter={2}
          />
          <ScrambleText
            text="LANGUAGE"
            class="text-everylanguage-white whitespace-nowrap text-4xl sm:text-5xl md:text-6xl tracking-tight"
            letterClass="font-display"
            shuffleTime={80}
            cyclesPerLetter={2}
          />
        </div>
      </div>
      <div
        class="mx-auto flex max-w-3xl flex-col items-center gap-8 text-center"
      >
        <div class="bg-white min-h-[200px] flex items-center justify-center">
          <AnimatedLogoReact client:load />
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .animate-fadeIn {
    animation: fadeIn 1s forwards;
  }
</style>

<script>
  import { animation, stagger, animate } from "../../utils/animation";

  function init() {
    var goProjectsButton = document.getElementById("go-projects-button");
    goProjectsButton?.addEventListener("click", function () {
      document.querySelector("#majestico-motto")?.scrollIntoView({
        behavior: "smooth",
      });
    });

    // Handle text splitting and animation
    const scrollText = document.querySelector("#hero .scroll-text");
    if (scrollText) {
      const splitResult = animation.splitText(scrollText, { type: "chars" });

      if (
        splitResult &&
        splitResult[0] &&
        splitResult[0].chars &&
        Array.isArray(splitResult[0].chars)
      ) {
        // Delay the text animation until after the title animation
        setTimeout(() => {
          animation.animate(
            splitResult[0].chars as HTMLElement[],
            { opacity: [0, 1] },
            {
              duration: 0.3,
              delay: stagger(0.05, { from: "center" }),
            }
          );
        }, 4000); // Adjust delay based on longer title animation time
      }
    }
  }

  document.removeEventListener("DOMContentLoaded", init); // astro:page-load
  document.addEventListener("DOMContentLoaded", init); // astro:page-load
</script>
